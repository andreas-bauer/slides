<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>reveal.js</title>

        <link rel="stylesheet" href="../reveal.js/dist/reset.css">
        <link rel="stylesheet" href="../reveal.js/dist/reveal.css">
        <link rel="stylesheet" href="../reveal.js/dist/theme/white.css">
        <link rel="stylesheet" href="custom.css">

        <!-- Theme used for syntax highlighted code -->
        <link rel="stylesheet" href="../reveal.js/plugin/highlight/monokai.css">

        <!-- Material Design icons as font-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h2>Firebase Introduction</h2>
                    <small>By Andreas Bauer</small>
                    <small>
                        <a
                          rel="license"
                          href="http://creativecommons.org/licenses/by/4.0/"
                        ></a
                        ><br />This work is licensed under a
                        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"
                          >Creative Commons Attribution 4.0 International License</a
                        >.
                      </small>
                </section>

                <section>
                    Why should we use such a thing as Firebase?
                </section>

                <section>
                    <div class="grid-container">
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">storage</i>
                                <p>Database</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">people</i>
                                <p>Authentication</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">perm_media</i>
                                <p>Cloud Storage</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%;">public</i>
                                <p>Hosting</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div>
                                <i class="material-icons" style="font-size: 300%">phone_iphone</i>
                                <i class="material-icons" style="font-size: 300%">laptop</i>
                                <p>Application</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">send</i>
                                <p>Messaging</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">memory</i>
                                <p>Cloud Functions</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">auto_graph</i>
                                <p>Scalability</p>
                            </div>
                        </div>
                        <div class="grid-item">
                            <div class="fragment">
                                <i class="material-icons" style="font-size: 200%">insert_chart_outlined</i>
                                <p>Analytics</p>
                            </div>
                        </div>
                      </div>
                </section>

                <section>
                    <p style="font-size:100px">üò∞</p>
                    But we wanted to develop an app and not a complete backend
                </section>

                <section>
                    <img width="50%" data-src="images/logo-standard.png">
                    <p>
                    Firebase is a development platform by Google that provides us with a Backend-as-a-Service so we can focus on our app
                    </p>
                </section>

                <section>
                    What do Google Cloud and Firebase have in common?
                    <img width="50%" data-src="images/cloud_and_firebase.png">
                    <p style="font-size:100px">üßê</p>
                </section>

                <section>
                    A Firebase project is a container for Google Cloud resources
                </section>

                <section data-background-image="images/google-cloud-overview.png" data-background-size="contain">
                    <!-- <span>Source: https://github.com/priyankavergadia/google-cloud-4-words</span> -->
                </section>

                <section data-background-image="images/firebase-overview.png" data-background-size="contain">

                </section>



                <section>
                    <h4>Setup Firebase</h4>
                    <p>

                        <ol>
                            <li>Go to <a href="https://console.firebase.google.com/">https://console.firebase.google.com/</a> </li>
                            <li>Create a new project</li>
                            <li>Store 'google-services.json' in project/app folder</li>
                            <li>Add Firebase SDKs to your Android project</li>
                        </ol>
                    </p>
                </section>

                <section>
                    <h4>Add Firebase SDKs to your app</h4>
                    <pre data-id="code-animation">
                        <code class="hljs" data-trim data-line-numbers="1,9">
                            <script type="text/template">
                                // file: build.gradle
                                buildscript {
                                    repositories {
                                        google()
                                        mavenCentral()
                                    }
                                    dependencies {
                                        classpath "com.android.tools.build:gradle:7.0.3"
                                        classpath "com.google.gms:google-services:4.3.10"
                                    }
                                }
                            </script>
                        </code>
                    </pre>
                </section>

                <section>
                    <h4>Add Firebase SDKs to your app</h4>
                    <pre data-id="code-animation">
                        <code class="hljs" data-trim data-line-numbers="1,4,8-11">
                            <script type="text/template">
                                // file: app/build.gradle
                                plugins {
                                    id 'com.android.application'
                                    id 'com.google.gms.google-services'
                                }
                                ...
                                dependencies {
                                    implementation platform('com.google.firebase:firebase-bom:28.4.2')
                                    implementation 'com.google.firebase:firebase-analytics'
                                    implementation 'com.google.firebase:firebase-auth'
                                    implementation 'com.google.firebase:firebase-firestore'
                                    ...
                                }
                            </script>
                        </code>
                    </pre>
                    <small>See <a href="https://firebase.google.com/docs/android/setup#available-libraries">available Firebase libraries</a>.</small>
                </section>

                <section>
                    <h4>Authentication</h4>
                </section>

                <section data-background-image="images/auth-sign-in-providers.png" data-background-size="contain"></section>

                <section data-background-image="images/auth-template.png" data-background-size="contain"></section>

                <section>
                    <h4>Firestore Storage</h4>

                    <ul>
                        <li>Store files like images, audio, video</li>
                        <li>Sharable with other Google Cloud services</li>
                    </ul>
                </section>

                <section>
                    <h4>Firestore Database</h4>

                    <ol>
                        <li>Document-oriented NoSQL database</li>
                        <li>Documents are organized in collections</li>
                        <li>Each document contains a set of key-value pairs</li>
                        <li>Hierarchy: Collection -> Document -> Data Field</li>
                    </ol>
                </section>

                <section>
                    <h4>Firestore Database Exercise</h4>
                    <ul>
                        <li>How would you design your Firestore DB when you have two collections that are in a relationship?</li>
                        <li>
                            <b>TODO:</b> Create a collection for <em>recipes</em> and one for <em>shopping lists</em> in Firebase
                            <ul>
                                <li>A shopping list consists of multiple recipes</li>
                                <li>Add sample data to demonstrate your solution</li>
                            </ul>

                        </li>
                    </ul>
                    <pre>
                        <code class="hljs" data-trim >
                            <script type="text/template">
                            interface Recipe {
                                val name: String
                                val servingSize: Int
                                var ingredients: String
                                // more properties
                            }
                            interface ShoppingList {
                                // ?
                            }
                            </script>
                        </code>
                    </pre>
                </section>

                <section data-auto-animate>
                    <h4 data-id="code-title">Set a document in Firestore (Java)</h4>
                    <pre data-id="code-animation">
                        <code class="hljs" data-trim data-line-numbers>
                            <script type="text/template">
                                // Source: https://firebase.google.com/docs/firestore/manage-data/add-data
                                Map<String, Object> city = new HashMap<>();
                                city.put("name", "Los Angeles");
                                city.put("state", "CA");
                                city.put("country", "USA");

                                db.collection("cities").document("LA")
                                .set(city)
                                .addOnSuccessListener(new OnSuccessListener<Void>() {
                                    @Override
                                    public void onSuccess(Void aVoid) {
                                        Log.d(TAG, "DocumentSnapshot successfully written!");
                                    }
                                })
                                .addOnFailureListener(new OnFailureListener() {
                                    @Override
                                    public void onFailure(@NonNull Exception e) {
                                        Log.w(TAG, "Error writing document", e);
                                    }
                                });
                            </script>
                        </code>
                    </pre>
                </section>

                <section data-auto-animate>
                    <h4 data-id="code-title">Set a document in Firestore (Kotlin)</h4>
                    <pre data-id="code-animation">
                        <code class="hljs" data-trim data-line-numbers>
                            <script type="text/template">
                                // Source: https://firebase.google.com/docs/firestore/manage-data/add-data
                                val city = hashMapOf(
                                    "name" to "Los Angeles",
                                    "state" to "CA",
                                    "country" to "USA"
                                )

                                db.collection("cities").document("LA")
                                .set(city)
                                .addOnSuccessListener { Log.d(TAG, "DocumentSnapshot successfully written!") }
                                .addOnFailureListener { e -> Log.w(TAG, "Error writing document", e) }
                            </script>
                        </code>
                    </pre>
                </section>

                <section data-auto-animate>
                    <h4 data-id="code-title">Get a single document from Firestore (Kotlin)</h4>
                    <pre data-id="code-animation">
                        <code class="hljs" data-trim data-line-numbers >
                            <script type="text/template">
                                // Source: https://firebase.google.com/docs/firestore/manage-data/get-data
                                val docRef = db.collection("cities").document("SF")
                                docRef.get()
                                .addOnSuccessListener { document ->
                                    if (document != null) {
                                        Log.d(TAG, "DocumentSnapshot data: ${document.data}")
                                    } else {
                                        Log.d(TAG, "No such document")
                                    }
                                }
                                .addOnFailureListener { exception ->
                                    Log.d(TAG, "get failed with ", exception)
                                }
                            </script>
                        </code>
                    </pre>
                </section>

                <section data-auto-animate>
                    <h4 data-id="code-title">Get multiple documents from Firestore (Kotlin)</h4>
                    <pre data-id="code-animation">
                        <code class="kotlin" data-trim data-line-numbers >
                            <script type="text/template">
                                // Source: https://firebase.google.com/docs/firestore/manage-data/get-data
                                db.collection("cities")
                                .whereEqualTo("capital", true)
                                .get()
                                .addOnSuccessListener { documents ->
                                    for (document in documents) {
                                        Log.d(TAG, "${document.id} => ${document.data}")
                                    }
                                }
                                .addOnFailureListener { exception ->
                                    Log.w(TAG, "Error getting documents: ", exception)
                                }
                            </script>
                        </code>
                    </pre>
                </section>

                <section>
                    <h4>Firestore Rules Exercise</h4>
                    <ul>
                        <li>The next slide presents three Firestore access rules</li>
                        <li><b>TODO:</b>Find for each of presented rules three example collections that would fit the domain of your app</li>
                    </ul>

                </section>

                <section data-auto-animate>
                    <h4 data-id="code-title">Firestore rules</h4>
                    <pre data-id="code-animation">
                        <code class="hljs" data-trim data-line-numbers="1-14|4-6|7-9|10-13" >
                            <script type="text/template">
                                rules_version = '2';
                                service cloud.firestore {
                                match /databases/{database}/documents {
                                    match /collection_A/{document=**} {
                                        allow read, write: if request.auth != null;
                                    }
                                    match /collection_B/{document=**} {
                                        allow read, write: if false;
                                    }
                                    match /collection_C/{document=**} {
                                        allow read: if true;
                                        allow write: if false;
                                    }
                                }}
                            </script>
                        </code>
                    </pre>
                </section>

                <section>
                    <h4>Prod vs Dev Environment</h4>
                    <ul>
                        <li>Create separate projects for development and production environment</li>
                        <li>Automate deployment to development and production environment (CI/CD)</li>
                    </ul>
                </section>

                <section>
                    <h4>Firestore Gotchas</h4>
                    <ul>
                        <li>Limitations of querying documents</li>
                        <li>Counting documents in a collection</li>
                        <li>OnUpdate() loop in cloud functions</li>
                        <li>Complex rules, e.g. only allowed to update specific fields</li>
                    </ul>
                </section>

                <section>
                    <h4>Alternative Providers</h4>
                    <ul>
                        <li>AWS Amplify</li>
                        <li>Azure Mobile Apps Service</li>
                        <li>Heroku</li>
                        <li>Netlify</li>
                        <li>Supabase</li>
                        <li>PlanetScale</li>
                    </ul>
                </section>

            </div>
            <footer style="position:absolute;width:calc(100% - 1em);bottom:0;font-size:40%;z-index:1;display:flex;justify-content:space-between;padding:0.5em">
                <span>https://andreas-bauer.github.io/slides/10-firebase-introduction</span>
            </footer>
        </div>

        <script src="../reveal.js/dist/reveal.js"></script>
        <script src="../reveal.js/plugin/notes/notes.js"></script>
        <script src="../reveal.js/plugin/markdown/markdown.js"></script>
        <script src="../reveal.js/plugin/highlight/highlight.js"></script>
        <script>
            // More info about initialization & config:
            // - https://revealjs.com/initialization/
            // - https://revealjs.com/config/
            Reveal.initialize({
                hash: true,
                slideNumber: true,

                // Learn about plugins: https://revealjs.com/plugins/
                plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
            });
        </script>
    </body>
</html>
